<view class="container">
  <!-- 加载状态 -->
  <view wx:if="{{loading}}" class="loading-container">
    <text>加载中...</text>
  </view>

  <!-- 支付页面 -->
  <view wx:else class="payment-container">
    <!-- 倒计时提醒 -->
    <view class="countdown-section">
      <text class="countdown-label">支付剩余时间</text>
      <text class="countdown-time" style="color: {{theme.colors.primary}}">{{formatCountDown(countDown)}}</text>
    </view>

    <!-- 订单信息 -->
    <view class="order-section">
      <view class="section-title">订单信息</view>
      <view class="order-info">
        <text class="event-title">{{order.eventTitle}}</text>
        <text class="event-time">{{order.eventDate}} {{order.eventTime}}</text>
        <text class="event-venue">{{order.venue}}</text>
        <text class="ticket-info">{{order.priceOptionName}} × {{order.quantity}}</text>
        
        <view class="order-detail">
          <view class="detail-row">
            <text class="detail-label">订单号</text>
            <text class="detail-value" bindtap="onCopyOrderId">{{order.id}}</text>
          </view>
          <view class="detail-row">
            <text class="detail-label">联系人</text>
            <text class="detail-value">{{order.userName}}</text>
          </view>
          <view class="detail-row">
            <text class="detail-label">手机号</text>
            <text class="detail-value">{{order.userPhone}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- 票券信息 -->
    <view class="tickets-section">
      <view class="section-title">票券信息</view>
      <view class="tickets-info" bindtap="onViewTickets">
        <text class="tickets-text">共{{order.tickets.length}}张票券，点击查看详情</text>
        <text class="tickets-arrow">></text>
      </view>
    </view>

    <!-- 价格明细 -->
    <view class="price-section">
      <view class="section-title">价格明细</view>
      <view class="price-details">
        <view class="price-row">
          <text class="price-label">{{order.priceOptionName}} × {{order.quantity}}</text>
          <text class="price-value">¥{{order.totalAmount}}</text>
        </view>
        <view class="price-row total">
          <text class="price-label">实付金额</text>
          <text class="price-value total-amount" style="color: {{theme.colors.primary}}">¥{{order.totalAmount}}</text>
        </view>
      </view>
    </view>

    <!-- 支付方式 -->
    <view class="payment-method-section">
      <view class="section-title">支付方式</view>
      <view class="payment-methods">
        <view class="payment-method selected">
          <image class="payment-icon" src="/assets/icons/wechat-pay.png" />
          <text class="payment-name">微信支付</text>
          <text class="payment-check" style="color: {{theme.colors.primary}}">✓</text>
        </view>
      </view>
    </view>

    <!-- 温馨提示 -->
    <view class="tips-section">
      <view class="section-title">温馨提示</view>
      <view class="tips-content">
        <text class="tip-item">• 请在规定时间内完成支付，超时订单将自动取消</text>
        <text class="tip-item">• 票券将在支付成功后生成，请妥善保管</text>
        <text class="tip-item">• 演出开始前30分钟停止检票，请提前到场</text>
        <text class="tip-item">• 如有疑问请联系客服：400-123-4567</text>
      </view>
    </view>
  </view>

  <!-- 底部支付按钮 -->
  <view wx:if="{{!loading && order}}" class="bottom-bar">
    <view class="payment-amount">
      <text class="amount-label">需支付</text>
      <text class="amount-value" style="color: {{theme.colors.primary}}">¥{{order.totalAmount}}</text>
    </view>
    <button 
      class="pay-btn" 
      bindtap="handleWechatPay"
      loading="{{paying}}"
      disabled="{{paying}}"
      style="background-color: {{theme.colors.primary}}"
    >
      {{paying ? '支付中...' : '立即支付'}}
    </button>
  </view>

  <!-- 帮助按钮 -->
  <view wx:if="{{!loading}}" class="help-section">
    <text class="help-link" bindtap="onContactService">遇到问题？联系客服</text>
  </view>
</view>